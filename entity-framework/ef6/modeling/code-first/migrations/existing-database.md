---
title: 使用現有的資料庫 Code First 移轉 EF6
author: divega
ms.date: 10/23/2016
ms.assetid: f0cc4f93-67dd-4664-9753-0a9f913814db
ms.openlocfilehash: eb7948eafb1322cabcf69b47bd5411f762fe8498
ms.sourcegitcommit: cc0ff36e46e9ed3527638f7208000e8521faef2e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/06/2020
ms.locfileid: "78418990"
---
# <a name="code-first-migrations-with-an-existing-database"></a><span data-ttu-id="bfe95-102">現有資料庫的 Code First 移轉</span><span class="sxs-lookup"><span data-stu-id="bfe95-102">Code First Migrations with an existing database</span></span>
> [!NOTE]
> <span data-ttu-id="bfe95-103">**僅限 ef 4.3** ，此頁面中所討論的功能、api 等已在 Entity Framework 4.1 中引進。</span><span class="sxs-lookup"><span data-stu-id="bfe95-103">**EF4.3 Onwards Only** - The features, APIs, etc. discussed in this page were introduced in Entity Framework 4.1.</span></span> <span data-ttu-id="bfe95-104">如果您使用的是較早版本，則不適用部分或全部的資訊。</span><span class="sxs-lookup"><span data-stu-id="bfe95-104">If you are using an earlier version, some or all of the information does not apply.</span></span>

<span data-ttu-id="bfe95-105">本文說明如何使用 Code First 移轉搭配現有的資料庫，而不是由 Entity Framework 所建立。</span><span class="sxs-lookup"><span data-stu-id="bfe95-105">This article covers using Code First Migrations with an existing database, one that wasn’t created by Entity Framework.</span></span>

> [!NOTE]
> <span data-ttu-id="bfe95-106">本文假設您知道如何在基本案例中使用 Code First 移轉。</span><span class="sxs-lookup"><span data-stu-id="bfe95-106">This article assumes you know how to use Code First Migrations in basic scenarios.</span></span> <span data-ttu-id="bfe95-107">如果您沒有這麼做，則必須先閱讀[Code First 移轉](~/ef6/modeling/code-first/migrations/index.md)，才能繼續進行。</span><span class="sxs-lookup"><span data-stu-id="bfe95-107">If you don’t, then you’ll need to read [Code First Migrations](~/ef6/modeling/code-first/migrations/index.md) before continuing.</span></span>

## <a name="screencasts"></a><span data-ttu-id="bfe95-108">螢幕錄製影片</span><span class="sxs-lookup"><span data-stu-id="bfe95-108">Screencasts</span></span>

<span data-ttu-id="bfe95-109">如果您想要觀賞螢幕錄製影片，而不是閱讀本文，下列兩段影片涵蓋的內容與本文相同。</span><span class="sxs-lookup"><span data-stu-id="bfe95-109">If you'd rather watch a screencast than read this article, the following two videos cover the same content as this article.</span></span>

### <a name="video-one-migrations---under-the-hood"></a><span data-ttu-id="bfe95-110">影片一：「在幕後進行遷移」</span><span class="sxs-lookup"><span data-stu-id="bfe95-110">Video One: "Migrations - Under the Hood"</span></span>

<span data-ttu-id="bfe95-111">[此螢幕錄製影片](https://channel9.msdn.com/blogs/ef/migrations-under-the-hood)涵蓋遷移如何追蹤和使用模型的相關資訊，以偵測模型的變更。</span><span class="sxs-lookup"><span data-stu-id="bfe95-111">[This screencast](https://channel9.msdn.com/blogs/ef/migrations-under-the-hood) covers how migrations tracks and uses information about the model to detect model changes.</span></span>

### <a name="video-two-migrations---existing-databases"></a><span data-ttu-id="bfe95-112">影片二：「遷移-現有的資料庫」</span><span class="sxs-lookup"><span data-stu-id="bfe95-112">Video Two: "Migrations - Existing Databases"</span></span>

<span data-ttu-id="bfe95-113">以上一段影片的概念為基礎，[此螢幕錄製影片](https://channel9.msdn.com/blogs/ef/migrations-existing-databases)涵蓋如何啟用和使用現有資料庫的遷移。</span><span class="sxs-lookup"><span data-stu-id="bfe95-113">Building on the concepts from the previous video, [this screencast](https://channel9.msdn.com/blogs/ef/migrations-existing-databases) covers how to enable and use migrations with an existing database.</span></span>

## <a name="step-1-create-a-model"></a><span data-ttu-id="bfe95-114">步驟1：建立模型</span><span class="sxs-lookup"><span data-stu-id="bfe95-114">Step 1: Create a model</span></span>

<span data-ttu-id="bfe95-115">您的第一個步驟是建立以現有資料庫為目標的 Code First 模型。</span><span class="sxs-lookup"><span data-stu-id="bfe95-115">Your first step will be to create a Code First model that targets your existing database.</span></span> <span data-ttu-id="bfe95-116">[現有資料庫的 Code First](~/ef6/modeling/code-first/workflows/existing-database.md)主題提供如何執行此動作的詳細指引。</span><span class="sxs-lookup"><span data-stu-id="bfe95-116">The [Code First to an Existing Database](~/ef6/modeling/code-first/workflows/existing-database.md) topic provides detailed guidance on how to do this.</span></span>

>[!NOTE]
> <span data-ttu-id="bfe95-117">請務必遵循本主題中的其餘步驟，再對需要變更資料庫架構的模型進行任何變更。</span><span class="sxs-lookup"><span data-stu-id="bfe95-117">It is important to follow the rest of the steps in this topic before making any changes to your model that would require changes to the database schema.</span></span> <span data-ttu-id="bfe95-118">下列步驟需要模型與資料庫架構同步。</span><span class="sxs-lookup"><span data-stu-id="bfe95-118">The following steps require the model to be in-sync with the database schema.</span></span>

## <a name="step-2-enable-migrations"></a><span data-ttu-id="bfe95-119">步驟2：啟用遷移</span><span class="sxs-lookup"><span data-stu-id="bfe95-119">Step 2: Enable Migrations</span></span>

<span data-ttu-id="bfe95-120">下一個步驟是啟用遷移。</span><span class="sxs-lookup"><span data-stu-id="bfe95-120">The next step is to enable migrations.</span></span> <span data-ttu-id="bfe95-121">您可以在 [套件管理員主控台] 中執行 [**啟用-遷移**] 命令來完成此動作。</span><span class="sxs-lookup"><span data-stu-id="bfe95-121">You can do this by running the **Enable-Migrations** command in Package Manager Console.</span></span>

<span data-ttu-id="bfe95-122">此命令會在您的解決方案中建立名為「遷移」的資料夾，並在其中放入名為 Configuration 的單一類別。</span><span class="sxs-lookup"><span data-stu-id="bfe95-122">This command will create a folder in your solution called Migrations, and put a single class inside it called Configuration.</span></span> <span data-ttu-id="bfe95-123">設定類別是您為應用程式設定遷移的位置，您可以在[Code First 移轉](~/ef6/modeling/code-first/migrations/index.md)主題中找到更多的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="bfe95-123">The Configuration class is where you configure migrations for your application, you can find out more about it in the [Code First Migrations](~/ef6/modeling/code-first/migrations/index.md) topic.</span></span>

## <a name="step-3-add-an-initial-migration"></a><span data-ttu-id="bfe95-124">步驟3：新增初始遷移</span><span class="sxs-lookup"><span data-stu-id="bfe95-124">Step 3: Add an initial migration</span></span>

<span data-ttu-id="bfe95-125">一旦建立遷移並套用至本機資料庫，您可能也會想要將這些變更套用至其他資料庫。</span><span class="sxs-lookup"><span data-stu-id="bfe95-125">Once migrations have been created and applied to the local database you may also want to apply these changes to other databases.</span></span> <span data-ttu-id="bfe95-126">例如，您的本機資料庫可能是測試資料庫，而且您最終可能也會想要將變更套用到生產資料庫和/或其他開發人員測試資料庫。</span><span class="sxs-lookup"><span data-stu-id="bfe95-126">For example, your local database may be a test database and you may ultimately want to also apply the changes to a production database and/or other developers test databases.</span></span> <span data-ttu-id="bfe95-127">此步驟有兩個選項，而您應挑選的選項取決於其他任何資料庫的架構是否空白，或目前是否符合本機資料庫的架構。</span><span class="sxs-lookup"><span data-stu-id="bfe95-127">There are two options for this step and the one you should pick depends whether or not the schema of any other databases is empty or currently matches the schema of the local database.</span></span>

-   <span data-ttu-id="bfe95-128">**選項一：使用現有的架構做為起點。**</span><span class="sxs-lookup"><span data-stu-id="bfe95-128">**Option One: Use existing schema as starting point.**</span></span> <span data-ttu-id="bfe95-129">當未來將套用其他的資料庫時，您應該使用這個方法，其架構與您的本機資料庫相同。</span><span class="sxs-lookup"><span data-stu-id="bfe95-129">You should use this approach when other databases that migrations will be applied to in the future will have the same schema as your local database currently has.</span></span> <span data-ttu-id="bfe95-130">例如，如果您的本機測試資料庫目前符合生產資料庫的 v1，而且您稍後將會套用這些遷移，將您的生產資料庫更新為 v2，您可能會使用此專案。</span><span class="sxs-lookup"><span data-stu-id="bfe95-130">For example, you might use this if your local test database currently matches v1 of your production database and you will later apply these migrations to update your production database to v2.</span></span>
-   <span data-ttu-id="bfe95-131">**選項二：使用空白資料庫做為起點。**</span><span class="sxs-lookup"><span data-stu-id="bfe95-131">**Option Two: Use empty database as starting point.**</span></span> <span data-ttu-id="bfe95-132">當未來將套用的其他資料庫是空的（或尚不存在）時，您應該使用此方法。</span><span class="sxs-lookup"><span data-stu-id="bfe95-132">You should use this approach when other databases that migrations will be applied to in the future are empty (or do not exist yet).</span></span> <span data-ttu-id="bfe95-133">例如，如果您使用測試資料庫開始開發應用程式，但未使用遷移，則您可能會使用此設定，而您稍後想要從頭建立生產資料庫。</span><span class="sxs-lookup"><span data-stu-id="bfe95-133">For example, you might use this if you started developing your application using a test database but without using migrations and you will later want to create a production database from scratch.</span></span>

### <a name="option-one-use-existing-schema-as-a-starting-point"></a><span data-ttu-id="bfe95-134">選項一：使用現有的架構做為起點</span><span class="sxs-lookup"><span data-stu-id="bfe95-134">Option One: Use existing schema as a starting point</span></span>

<span data-ttu-id="bfe95-135">Code First 移轉會使用儲存在最新的遷移中的模型快照集來偵測模型的變更（您可以在[小組環境的 Code First 移轉](~/ef6/modeling/code-first/migrations/teams.md)中找到詳細資訊）。</span><span class="sxs-lookup"><span data-stu-id="bfe95-135">Code First Migrations uses a snapshot of the model stored in the most recent migration to detect changes to the model (you can find detailed information about this in [Code First Migrations in Team Environments](~/ef6/modeling/code-first/migrations/teams.md)).</span></span> <span data-ttu-id="bfe95-136">因為我們將假設資料庫已經有目前模型的架構，所以我們會產生一個空的（無 op）遷移，其以目前的模型做為快照集。</span><span class="sxs-lookup"><span data-stu-id="bfe95-136">Since we are going to assume that databases already have the schema of the current model, we will generate an empty (no-op) migration that has the current model as a snapshot.</span></span>

1.  <span data-ttu-id="bfe95-137">執行 [套件管理員主控台] 中的 [**新增-遷移 InitialCreate – IgnoreChanges** ] 命令。</span><span class="sxs-lookup"><span data-stu-id="bfe95-137">Run the **Add-Migration InitialCreate –IgnoreChanges** command in Package Manager Console.</span></span> <span data-ttu-id="bfe95-138">這會使用目前的模型做為快照集來建立空的遷移。</span><span class="sxs-lookup"><span data-stu-id="bfe95-138">This creates an empty migration with the current model as a snapshot.</span></span>
2.  <span data-ttu-id="bfe95-139">在 [套件管理員主控台] 中執行 [**更新-資料庫**] 命令。</span><span class="sxs-lookup"><span data-stu-id="bfe95-139">Run the **Update-Database** command in Package Manager Console.</span></span> <span data-ttu-id="bfe95-140">這會將 InitialCreate 遷移套用至資料庫。</span><span class="sxs-lookup"><span data-stu-id="bfe95-140">This will apply the InitialCreate migration to the database.</span></span> <span data-ttu-id="bfe95-141">因為實際的遷移並未包含任何變更，所以只會將資料列新增至 \_\_MigrationsHistory 資料表，表示已套用此遷移。</span><span class="sxs-lookup"><span data-stu-id="bfe95-141">Since the actual migration doesn’t contain any changes, it will simply add a row to the \_\_MigrationsHistory table indicating that this migration has already been applied.</span></span>

### <a name="option-two-use-empty-database-as-a-starting-point"></a><span data-ttu-id="bfe95-142">選項二：使用空白資料庫做為起點</span><span class="sxs-lookup"><span data-stu-id="bfe95-142">Option Two: Use empty database as a starting point</span></span>

<span data-ttu-id="bfe95-143">在此情況下，我們需要進行遷移，才能從頭開始建立整個資料庫，包括已存在於本機資料庫中的資料表。</span><span class="sxs-lookup"><span data-stu-id="bfe95-143">In this scenario we need Migrations to be able to create the entire database from scratch – including the tables that are already present in our local database.</span></span> <span data-ttu-id="bfe95-144">我們即將產生 InitialCreate 遷移，其中包含建立現有架構的邏輯。</span><span class="sxs-lookup"><span data-stu-id="bfe95-144">We’re going to generate an InitialCreate migration that includes logic to create the existing schema.</span></span> <span data-ttu-id="bfe95-145">接著，我們會讓現有的資料庫看起來像這種遷移已經套用。</span><span class="sxs-lookup"><span data-stu-id="bfe95-145">We’ll then make our existing database look like this migration has already been applied.</span></span>

1.  <span data-ttu-id="bfe95-146">在 [套件管理員主控台] 中執行 [**新增-遷移 InitialCreate** ] 命令。</span><span class="sxs-lookup"><span data-stu-id="bfe95-146">Run the **Add-Migration InitialCreate** command in Package Manager Console.</span></span> <span data-ttu-id="bfe95-147">這會建立一個遷移來建立現有的架構。</span><span class="sxs-lookup"><span data-stu-id="bfe95-147">This creates a migration to create the existing schema.</span></span>
2.  <span data-ttu-id="bfe95-148">將新建立之遷移的 Up 方法中的所有程式碼標記為批註。</span><span class="sxs-lookup"><span data-stu-id="bfe95-148">Comment out all code in the Up method of the newly created migration.</span></span> <span data-ttu-id="bfe95-149">這可讓我們「將」遷移到本機資料庫，而不需嘗試重新建立所有資料表等等。</span><span class="sxs-lookup"><span data-stu-id="bfe95-149">This will allow us to ‘apply’ the migration to the local database without trying to recreate all the tables etc. that already exist.</span></span>
3.  <span data-ttu-id="bfe95-150">在 [套件管理員主控台] 中執行 [**更新-資料庫**] 命令。</span><span class="sxs-lookup"><span data-stu-id="bfe95-150">Run the **Update-Database** command in Package Manager Console.</span></span> <span data-ttu-id="bfe95-151">這會將 InitialCreate 遷移套用至資料庫。</span><span class="sxs-lookup"><span data-stu-id="bfe95-151">This will apply the InitialCreate migration to the database.</span></span> <span data-ttu-id="bfe95-152">因為實際的遷移不會包含任何變更（因為我們暫時將其批註化），所以只會將資料列新增至 \_\_MigrationsHistory 資料表，表示已套用此遷移。</span><span class="sxs-lookup"><span data-stu-id="bfe95-152">Since the actual migration doesn’t contain any changes (because we temporarily commented them out), it will simply add a row to the \_\_MigrationsHistory table indicating that this migration has already been applied.</span></span>
4.  <span data-ttu-id="bfe95-153">將 Up 方法中的程式碼取消批註。</span><span class="sxs-lookup"><span data-stu-id="bfe95-153">Un-comment the code in the Up method.</span></span> <span data-ttu-id="bfe95-154">這表示當此遷移套用至未來的資料庫時，會透過遷移來建立已存在於本機資料庫中的架構。</span><span class="sxs-lookup"><span data-stu-id="bfe95-154">This means that when this migration is applied to future databases, the schema that already existed in the local database will be created by migrations.</span></span>

## <a name="things-to-be-aware-of"></a><span data-ttu-id="bfe95-155">注意事項</span><span class="sxs-lookup"><span data-stu-id="bfe95-155">Things to be aware of</span></span>

<span data-ttu-id="bfe95-156">針對現有的資料庫使用遷移時，您必須注意幾件事。</span><span class="sxs-lookup"><span data-stu-id="bfe95-156">There are a few things you need to be aware of when using Migrations against an existing database.</span></span>

### <a name="defaultcalculated-names-may-not-match-existing-schema"></a><span data-ttu-id="bfe95-157">預設/計算的名稱可能與現有的架構不相符</span><span class="sxs-lookup"><span data-stu-id="bfe95-157">Default/calculated names may not match existing schema</span></span>

<span data-ttu-id="bfe95-158">在 scaffold 遷移時，遷移會明確指定資料行和資料表的名稱。</span><span class="sxs-lookup"><span data-stu-id="bfe95-158">Migrations explicitly specifies names for columns and tables when it scaffolds a migrations.</span></span> <span data-ttu-id="bfe95-159">不過，在套用遷移時，還有其他資料庫物件可供遷移計算的預設名稱。</span><span class="sxs-lookup"><span data-stu-id="bfe95-159">However, there are other database objects that Migrations calculates a default name for when applying the migrations.</span></span> <span data-ttu-id="bfe95-160">這包括索引和外鍵條件約束。</span><span class="sxs-lookup"><span data-stu-id="bfe95-160">This includes indexes and foreign key constraints.</span></span> <span data-ttu-id="bfe95-161">以現有的架構為目標時，這些匯出名稱可能不會符合資料庫中實際存在的內容。</span><span class="sxs-lookup"><span data-stu-id="bfe95-161">When targeting an existing schema, these calculated names may not match what actually exists in your database.</span></span>

<span data-ttu-id="bfe95-162">以下是一些需要注意的範例：</span><span class="sxs-lookup"><span data-stu-id="bfe95-162">Here are some examples of when you need to be aware of this:</span></span>

<span data-ttu-id="bfe95-163">**如果您使用「選項一：使用現有的架構做為起點」，請從步驟3：**</span><span class="sxs-lookup"><span data-stu-id="bfe95-163">**If you used ‘Option One: Use existing schema as a starting point’ from Step 3:**</span></span>

-   <span data-ttu-id="bfe95-164">如果模型中的未來變更需要變更或卸載以不同方式命名的其中一個資料庫物件，您將需要修改 scaffold 遷移來指定正確的名稱。</span><span class="sxs-lookup"><span data-stu-id="bfe95-164">If future changes in your model require changing or dropping one of the database objects that is named differently, you will need to modify the scaffolded migration to specify the correct name.</span></span> <span data-ttu-id="bfe95-165">遷移 Api 具有選擇性的 Name 參數，可讓您執行此動作。</span><span class="sxs-lookup"><span data-stu-id="bfe95-165">The Migrations APIs have an optional Name parameter that allows you to do this.</span></span>
    <span data-ttu-id="bfe95-166">例如，您現有的架構可能會有一個具有 BlogId 外鍵資料行的 Post 資料表，其索引名為 IndexFk\_BlogId。</span><span class="sxs-lookup"><span data-stu-id="bfe95-166">For example, your existing schema may have a Post table with a BlogId foreign key column that has an index named IndexFk\_BlogId.</span></span> <span data-ttu-id="bfe95-167">不過，根據預設，遷移會預期此索引會命名為 IX\_BlogId。</span><span class="sxs-lookup"><span data-stu-id="bfe95-167">However, by default Migrations would expect this index to be named IX\_BlogId.</span></span> <span data-ttu-id="bfe95-168">如果您對模型進行變更，而導致卸載此索引，您將需要修改 scaffold DropIndex 呼叫以指定 IndexFk\_BlogId 名稱。</span><span class="sxs-lookup"><span data-stu-id="bfe95-168">If you make a change to your model that results in dropping this index, you will need to modify the scaffolded DropIndex call to specify the IndexFk\_BlogId name.</span></span>

<span data-ttu-id="bfe95-169">**如果您使用了 ' Option 二：使用空白資料庫做為起點 ' （從步驟3：**</span><span class="sxs-lookup"><span data-stu-id="bfe95-169">**If you used ‘Option Two: Use empty database as a starting point’ from Step 3:**</span></span>

-   <span data-ttu-id="bfe95-170">嘗試對本機資料庫執行初始遷移的向下方法（也就是還原為空的資料庫）可能會失敗，因為遷移會嘗試使用不正確的名稱來卸載索引和外鍵條件約束。</span><span class="sxs-lookup"><span data-stu-id="bfe95-170">Trying to run the Down method of the initial migration (that is, reverting to an empty database) against your local database may fail because Migrations will try to drop indexes and foreign key constraints using the incorrect names.</span></span> <span data-ttu-id="bfe95-171">這只會影響您的本機資料庫，因為將會使用初始遷移的 Up 方法從頭開始建立其他資料庫。</span><span class="sxs-lookup"><span data-stu-id="bfe95-171">This will only affect your local database since other databases will be created from scratch using the Up method of the initial migration.</span></span>
    <span data-ttu-id="bfe95-172">如果您想要將現有的本機資料庫降級為空的狀態，您可以藉由卸載資料庫或卸載所有資料表，以手動方式執行這項操作。</span><span class="sxs-lookup"><span data-stu-id="bfe95-172">If you want to downgrade your existing local database to an empty state it is easiest to do this manually, either by dropping the database or dropping all the tables.</span></span> <span data-ttu-id="bfe95-173">在初始降級之後，將會使用預設名稱重新建立所有的資料庫物件，因此這個問題不會再次出現。</span><span class="sxs-lookup"><span data-stu-id="bfe95-173">After this initial downgrade all database objects will be recreated with the default names, so this issue will not present itself again.</span></span>
-   <span data-ttu-id="bfe95-174">如果模型中的未來變更需要變更或卸載以不同方式命名的其中一個資料庫物件，這將無法用於您現有的本機資料庫，因為名稱不會符合預設值。</span><span class="sxs-lookup"><span data-stu-id="bfe95-174">If future changes in your model require changing or dropping one of the database objects that is named differently, this will not work against your existing local database – since the names won’t match the defaults.</span></span> <span data-ttu-id="bfe95-175">不過，它會針對「從頭開始」建立的資料庫使用，因為它們會使用遷移所選擇的預設名稱。</span><span class="sxs-lookup"><span data-stu-id="bfe95-175">However, it will work against databases that were created ‘from scratch’ since they will have used the default names chosen by Migrations.</span></span>
    <span data-ttu-id="bfe95-176">您可以在本機現有資料庫上手動進行這些變更，或考慮讓遷移從頭開始重新建立資料庫–因為它會在其他電腦上。</span><span class="sxs-lookup"><span data-stu-id="bfe95-176">You could either make these changes manually on your local existing database, or consider having Migrations recreate your database from scratch – as it will on other machines.</span></span>
-   <span data-ttu-id="bfe95-177">使用初始遷移的 Up 方法所建立的資料庫，可能會與本機資料庫略有不同，因為將會使用計算出的索引和外鍵條件約束的預設名稱。</span><span class="sxs-lookup"><span data-stu-id="bfe95-177">Databases created using the Up method of your initial migration may differ slightly from the local database since the calculated default names for indexes and foreign key constraints will be used.</span></span> <span data-ttu-id="bfe95-178">最後，您可能也會有額外的索引，因為在預設的情況下，遷移將會在外鍵資料行上建立索引，這在您的原始本機資料庫中可能不會是這種情況。</span><span class="sxs-lookup"><span data-stu-id="bfe95-178">You may also end up with extra indexes as Migrations will create indexes on foreign key columns by default – this may not have been the case in your original local database.</span></span>

### <a name="not-all-database-objects-are-represented-in-the-model"></a><span data-ttu-id="bfe95-179">並非所有資料庫物件都是以模型表示</span><span class="sxs-lookup"><span data-stu-id="bfe95-179">Not all database objects are represented in the model</span></span>

<span data-ttu-id="bfe95-180">遷移不會處理不屬於您模型的資料庫物件。</span><span class="sxs-lookup"><span data-stu-id="bfe95-180">Database objects that are not part of your model will not be handled by Migrations.</span></span> <span data-ttu-id="bfe95-181">這可能包括視圖、預存程式、許可權、不屬於您模型的資料表、其他索引等等。</span><span class="sxs-lookup"><span data-stu-id="bfe95-181">This can include views, stored procedures, permissions, tables that are not part of your model, additional indexes, etc.</span></span>

<span data-ttu-id="bfe95-182">以下是一些需要注意的範例：</span><span class="sxs-lookup"><span data-stu-id="bfe95-182">Here are some examples of when you need to be aware of this:</span></span>

-   <span data-ttu-id="bfe95-183">不論您在「步驟3」中選擇哪一個選項，如果您模型中的未來變更需要變更或卸載這些額外的物件，遷移將不知道要進行這些變更。</span><span class="sxs-lookup"><span data-stu-id="bfe95-183">Regardless of the option you chose in ‘Step 3’, if future changes in your model require changing or dropping these additional objects Migrations will not know to make these changes.</span></span> <span data-ttu-id="bfe95-184">例如，如果您卸載的資料行上有額外的索引，則遷移並不知道要卸載索引。</span><span class="sxs-lookup"><span data-stu-id="bfe95-184">For example, if you drop a column that has an additional index on it, Migrations will not know to drop the index.</span></span> <span data-ttu-id="bfe95-185">您必須手動將此新增至 scaffold 遷移。</span><span class="sxs-lookup"><span data-stu-id="bfe95-185">You will need to manually add this to the scaffolded Migration.</span></span>
-   <span data-ttu-id="bfe95-186">如果您使用 ' Option 二：使用空白資料庫做為起點 '，則初始遷移的 Up 方法將不會建立這些額外的物件。</span><span class="sxs-lookup"><span data-stu-id="bfe95-186">If you used ‘Option Two: Use empty database as a starting point’, these additional objects will not be created by the Up method of your initial migration.</span></span>
    <span data-ttu-id="bfe95-187">如有需要，您可以修改 Up 和 Down 方法，以處理這些額外的物件。</span><span class="sxs-lookup"><span data-stu-id="bfe95-187">You can modify the Up and Down methods to take care of these additional objects if you wish.</span></span> <span data-ttu-id="bfe95-188">對於在遷移 API 中原本不支援的物件（例如 views），您可以使用[Sql](https://msdn.microsoft.com/library/system.data.entity.migrations.dbmigration.sql.aspx)方法來執行原始 sql 來建立/卸載它們。</span><span class="sxs-lookup"><span data-stu-id="bfe95-188">For objects that are not natively supported in the Migrations API – such as views – you can use the [Sql](https://msdn.microsoft.com/library/system.data.entity.migrations.dbmigration.sql.aspx) method to run raw SQL to create/drop them.</span></span>
