---
title: 關聯性-EF 設計工具-EF6
author: divega
ms.date: 10/23/2016
ms.assetid: 402fe960-754b-470f-976b-e5de3e9986b5
ms.openlocfilehash: d429c39dafbf183caabdc85748c188deb8dd6f66
ms.sourcegitcommit: cc0ff36e46e9ed3527638f7208000e8521faef2e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/06/2020
ms.locfileid: "78418242"
---
# <a name="relationships---ef-designer"></a>關聯性-EF 設計工具
> [!NOTE]
> 此頁面提供有關使用 EF 設計工具在模型中設定關聯性的資訊。 如需 EF 中關聯性和如何使用關聯性存取和運算元據的一般資訊，請參閱[& 導覽屬性的關聯](~/ef6/fundamentals/relationships.md)性。

關聯會定義模型中實體類型之間的關係。 本主題說明如何使用 Entity Framework Designer （EF Designer）對應關聯。 下圖顯示使用 EF 設計工具時的主要視窗。

![EF Designer](~/ef6/media/efdesigner.png)

> [!NOTE]
> 建置概念模型時，與未對應之實體和關聯有關的警告可能會在 [錯誤清單] 中出現。 您可以忽略這些警告，因為在您選擇從模型產生資料庫之後，錯誤就會消失。

## <a name="associations-overview"></a>關聯總覽

當您使用 EF 設計工具設計模型時，.edmx 檔案會代表您的模型。 在 .edmx 檔案中，Association 元素會定義兩個實體類型之間的**關聯**性。 關聯 (Association) 必須指定關聯性 (relationship) 中的相關實體類型，以及關聯性每一端可能的實體類型數量 (也就是「多重性」)。 關聯端點的多重性可以有一（1）、零或一（0 ..1），或多個（\*）的值。 這項資訊是在兩個子系**End**元素中指定。

在執行時間，可以透過導覽屬性或外鍵來存取關聯一端的實體類型實例（如果您選擇要公開實體中的外鍵）。 公開外鍵後，實體之間的關聯性會使用**ReferentialConstraint**專案（ **Association**元素的子項目）來管理。 建議您一律針對實體中的關聯性公開外鍵。

> [!NOTE]
> 在多對多（\*：\*）中，您無法將外鍵加入至實體。 在 \*：\* 關聯性中，會使用獨立物件來管理關聯資訊。

如需 CSDL 元素（**ReferentialConstraint**、**關聯**等）的相關資訊，請參閱[csdl 規格](~/ef6/modeling/designer/advanced/edmx/csdl-spec.md)。

## <a name="create-and-delete-associations"></a>建立和刪除關聯

使用 EF Designer 建立關聯會更新 .edmx 檔案的模型內容。 建立關聯之後，您必須建立關聯的對應（本主題稍後會討論）。

> [!NOTE]
> 本節假設您已經加入您想要在模型之間建立關聯的實體。

### <a name="to-create-an-association"></a>建立關聯

1.  以滑鼠右鍵按一下設計介面的空白區域，指向 [ **加入新**的]，然後選取 [ **關聯**]。
2.  在 [**加入關聯**] 對話方塊中，填入關聯的設定。

    ![新增關聯](~/ef6/media/addassociation.png)

    > [!NOTE]
    > 您可以藉由清除 **導覽屬性 **並 **將外鍵屬性加入&gt; 實體 核取方塊的 &lt;實體類型名稱 **，選擇不要將導覽屬性或外鍵屬性加入至關聯結尾的實體。 如果您只加入一個導覽屬性，則關聯只能單向周遊。 如果不加入任何導覽屬性，您必須選擇加入外部索引鍵屬性，才能存取關聯 End 的實體。
    
3.  按一下 **[確定]** 。

### <a name="to-delete-an-association"></a>若要刪除關聯

若要刪除關聯，請執行下列其中一項動作：

-   在 EF 設計工具介面上，以滑鼠右鍵按一下關聯，然後選取 [ **刪除**]。

- 或 -

-   選取一個或多個關聯，然後按下 DELETE 鍵。

## <a name="include-foreign-key-properties-in-your-entities-referential-constraints"></a>在您的實體中包含外鍵屬性（參考條件約束）

建議您一律針對實體中的關聯性公開外鍵。 Entity Framework 使用參考條件約束來識別屬性是否做為關聯性的外鍵。

如果您在建立關聯性時，核取了 [***將外鍵屬性加入至 &lt;實體類型名稱&gt; 實體***] 核取方塊，就會為您新增此參考條件約束。

當您使用 EF 設計工具來加入或編輯參考條件約束時，EF 設計工具會在 .edmx 檔案的 CSDL 內容中加入或修改**ReferentialConstraint** 元素。

-   按兩下您要編輯的關聯。
    [ **參考條件約束** ] 對話方塊隨即出現。
-   從 [ **主體** ] 下拉式清單中，選取參考條件約束中的 [主體] 實體。
    實體的索引鍵屬性會加入至對話方塊的 [ **主體索引鍵** ] 清單中。
-   從 [ **相依** ] 下拉式清單中，選取參考條件約束中的相依實體。
-   針對具有相依索引鍵的每個主體索引鍵，從 [ **相依索引鍵** ] 資料行的下拉式清單中選取對應的相依索引鍵。

    ![Ref 條件約束](~/ef6/media/refconstraint.png)

-   按一下 **[確定]** 。

## <a name="create-and-edit-association-mappings"></a>建立和編輯關聯對應

您可以在 EF 設計工具的 **對應詳細資料**  視窗中，指定關聯對應至資料庫的方式。

> [!NOTE]
> 您只能對應未指定參考條件約束之關聯的詳細資料。 如果指定了參考條件約束，則實體中會包含外鍵屬性，而且您可以使用實體的對應詳細資料，來控制外鍵要對應至哪個資料行。

### <a name="create-an-association-mapping"></a>建立關聯對應

-   以滑鼠右鍵按一下設計介面中的關聯，然後選取 [ **資料表對應**]。
    這會在  **對應詳細資料**  視窗中顯示關聯對應。
-   按一下 [ **加入資料表或視圖**]。
    包含儲存體模型中所有資料表的下拉式清單便會出現。
-   選取此關聯將要對應的資料表。
    [ **對應詳細資料** ] 視窗會顯示關聯的兩端，以及每**一端**之實體類型的索引鍵屬性。
-   針對每個索引鍵屬性，按一下資料 **行**  欄位，然後選取屬性將對應的資料行。

    ![對應詳細資料4](~/ef6/media/mappingdetails4.png)

### <a name="edit-an-association-mapping"></a>編輯關聯對應

-   以滑鼠右鍵按一下設計介面中的關聯，然後選取 [ **資料表對應**]。
    這會在  **對應詳細資料**  視窗中顯示關聯對應。
-   按一下 [ **對應] &lt;資料表名稱&gt;** 。
    包含儲存體模型中所有資料表的下拉式清單便會出現。
-   選取此關聯將要對應的資料表。
    [ **對應詳細資料** ] 視窗會顯示關聯的兩端，以及每一端之實體類型的索引鍵屬性。
-   針對每個索引鍵屬性，按一下資料 **行**  欄位，然後選取屬性將對應的資料行。

## <a name="edit-and-delete-navigation-properties"></a>編輯和刪除導覽屬性

導覽屬性是用來在模型中的關聯端點上尋找實體的快捷方式屬性。 當您在兩個實體類型之間建立關聯時，可以建立導覽屬性。

#### <a name="to-edit-navigation-properties"></a>編輯導覽屬性

-   選取 EF 設計工具介面上的導覽屬性。
    導覽屬性的相關資訊會顯示在 Visual Studio **屬性**  視窗中。
-   變更  **屬性**  視窗中的屬性設定。

#### <a name="to-delete-navigation-properties"></a>刪除導覽屬性

-   如果未在概念模型中的實體類型上公開外部索引鍵，刪除導覽屬性可能會使對應的關聯只能單向周遊，或者完全不能周遊。
-   以滑鼠右鍵按一下 EF 設計工具介面上的導覽屬性，然後選取 [ **刪除**]。
